digraph SimpleProtocol {

    node
        [shape=Mrecord width=1.5];

    subgraph cluster_Simple {

        label="Simple";

        //
        // States (Nodes)
        //

        "Simple::Initial"
            [label="{Initial}"];

        "Simple::Connected"
            [label="{Connected}"];

        "Simple::Closed"
            [label="{Closed}"];

        "Simple::ProtocolError"
            [label="{ProtocolError}"];

        "Simple::Connected::SimpleClient"
            [label="{SimpleClient|O-O\r}"]

        "Simple::Connected::SimpleServer"
            [label="{SimpleServer|O-O\r}"]

        "%start"
            [label="" shape=circle style=filled fillcolor=black width=0.25];

        "push(SimpleServer::Accept)"
            [label="" shape=plaintext];

        "push(SimpleClient::Connect)"
            [label="" shape=plaintext];

        //
        // Transitions (Edges)
        //

        "Simple::Initial" -> "Simple::Connected::SimpleClient"
            [label="accepted/\lpush(SimpleClient::Connect)\l"];

        "Simple::Initial" -> "Simple::Connected::SimpleServer"
            [label="connected/\lpush(SimpleServer::Accept)\l"];

        "Simple::Initial" -> "Simple::ProtocolError"
            [label="closing/\l"];

        "Simple::Initial" -> "Simple::ProtocolError"
            [label="readError/\l"];

        "Simple::Initial" -> "Simple::ProtocolError"
            [label="writeError/\l"];

        "Simple::Initial" -> "Simple::ProtocolError"
            [label="readReady/\l"];

        "Simple::Initial" -> "Simple::ProtocolError"
            [label="writeReady/\l"];

        "Simple::Connected" -> "Simple::ProtocolError"
            [label="closing/\l"];

        "Simple::Connected" -> "Simple::ProtocolError"
            [label="readError/\l"];

        "Simple::Connected" -> "Simple::ProtocolError"
            [label="writeError/\l"];

        "Simple::Connected" -> "Simple::ProtocolError"
            [label="readReady/\l"];

        "Simple::Connected" -> "Simple::ProtocolError"
            [label="writeReady/\l"];

        "Simple::Closed" -> "Simple::ProtocolError"
            [label="closing/\l"];

        "Simple::Closed" -> "Simple::ProtocolError"
            [label="readError/\l"];

        "Simple::Closed" -> "Simple::ProtocolError"
            [label="writeError/\l"];

        "Simple::Closed" -> "Simple::ProtocolError"
            [label="readReady/\l"];

        "Simple::Closed" -> "Simple::ProtocolError"
            [label="writeReady/\l"];

        "Simple::ProtocolError" -> "Simple::ProtocolError"
            [label="closing/\l"];

        "Simple::ProtocolError" -> "Simple::ProtocolError"
            [label="readError/\l"];

        "Simple::ProtocolError" -> "Simple::ProtocolError"
            [label="writeError/\l"];

        "Simple::ProtocolError" -> "Simple::ProtocolError"
            [label="readReady/\l"];

        "Simple::ProtocolError" -> "Simple::ProtocolError"
            [label="writeReady/\l"];

        "Simple::Connected::SimpleClient" -> "Simple::Connected"
            [label="pop/"]

        "Simple::Connected::SimpleServer" -> "Simple::Connected"
            [label="pop/"]

        "%start" -> "Simple::Initial"

        "push(SimpleServer::Accept)" -> "SimpleServer::Accept"
            [arrowtail=odot];

        "push(SimpleClient::Connect)" -> "SimpleClient::Connect"
            [arrowtail=odot];
    }

    subgraph cluster_SimpleClient {

        label="SimpleClient";

        //
        // States (Nodes)
        //

        "SimpleClient::Connect"
            [label="{Connect}"];

        "SimpleClient::ProtocolError"
            [label="{ProtocolError}"];

        "push(SimpleClient::Connect)"
            [label="" shape=plaintext];

        //
        // Transitions (Edges)
        //

        "SimpleClient::Connect" -> "SimpleClient::ProtocolError"
            [label="accepted/\l"];

        "SimpleClient::Connect" -> "SimpleClient::ProtocolError"
            [label="closing/\l"];

        "SimpleClient::Connect" -> "SimpleClient::ProtocolError"
            [label="connected/\l"];

        "SimpleClient::Connect" -> "SimpleClient::ProtocolError"
            [label="readError/\l"];

        "SimpleClient::Connect" -> "SimpleClient::ProtocolError"
            [label="writeError/\l"];

        "SimpleClient::Connect" -> "SimpleClient::ProtocolError"
            [label="readReady/\l"];

        "SimpleClient::Connect" -> "SimpleClient::ProtocolError"
            [label="writeReady/\l"];

        "SimpleClient::ProtocolError" -> "SimpleClient::ProtocolError"
            [label="accepted/\l"];

        "SimpleClient::ProtocolError" -> "SimpleClient::ProtocolError"
            [label="closing/\l"];

        "SimpleClient::ProtocolError" -> "SimpleClient::ProtocolError"
            [label="connected/\l"];

        "SimpleClient::ProtocolError" -> "SimpleClient::ProtocolError"
            [label="readError/\l"];

        "SimpleClient::ProtocolError" -> "SimpleClient::ProtocolError"
            [label="writeError/\l"];

        "SimpleClient::ProtocolError" -> "SimpleClient::ProtocolError"
            [label="readReady/\l"];

        "SimpleClient::ProtocolError" -> "SimpleClient::ProtocolError"
            [label="writeReady/\l"];

        "push(SimpleClient::Connect)" -> "SimpleClient::Connect"
            [arrowtail=odot];
    }

    subgraph cluster_SimpleServer {

        label="SimpleServer";

        //
        // States (Nodes)
        //

        "SimpleServer::Accept"
            [label="{Accept}"];

        "SimpleServer::ProtocolError"
            [label="{ProtocolError}"];

        "push(SimpleServer::Accept)"
            [label="" shape=plaintext];

        //
        // Transitions (Edges)
        //

        "SimpleServer::Accept" -> "SimpleServer::ProtocolError"
            [label="accepted/\l"];

        "SimpleServer::Accept" -> "SimpleServer::ProtocolError"
            [label="closing/\l"];

        "SimpleServer::Accept" -> "SimpleServer::ProtocolError"
            [label="connected/\l"];

        "SimpleServer::Accept" -> "SimpleServer::ProtocolError"
            [label="readError/\l"];

        "SimpleServer::Accept" -> "SimpleServer::ProtocolError"
            [label="writeError/\l"];

        "SimpleServer::Accept" -> "SimpleServer::ProtocolError"
            [label="readReady/\l"];

        "SimpleServer::Accept" -> "SimpleServer::ProtocolError"
            [label="writeReady/\l"];

        "SimpleServer::ProtocolError" -> "SimpleServer::ProtocolError"
            [label="accepted/\l"];

        "SimpleServer::ProtocolError" -> "SimpleServer::ProtocolError"
            [label="closing/\l"];

        "SimpleServer::ProtocolError" -> "SimpleServer::ProtocolError"
            [label="connected/\l"];

        "SimpleServer::ProtocolError" -> "SimpleServer::ProtocolError"
            [label="readError/\l"];

        "SimpleServer::ProtocolError" -> "SimpleServer::ProtocolError"
            [label="writeError/\l"];

        "SimpleServer::ProtocolError" -> "SimpleServer::ProtocolError"
            [label="readReady/\l"];

        "SimpleServer::ProtocolError" -> "SimpleServer::ProtocolError"
            [label="writeReady/\l"];

        "push(SimpleServer::Accept)" -> "SimpleServer::Accept"
            [arrowtail=odot];
    }

}
